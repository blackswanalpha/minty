{
  "version": "1.1.0",
  "lastScanned": "2026-01-09T14:13:59.287Z",
  "projectId": "f2d44fa9-0faf-44c4-8d94-f7e0d50fc03b",
  "totalFiles": 3,
  "totalTokens": 1543,
  "files": [
    {
      "path": "package.json",
      "size": 538,
      "tokens": 135,
      "lastModified": "2026-01-09T14:06:59.213Z",
      "content": "{\n    \"name\": \"minty-cli\",\n    \"version\": \"0.1.0\",\n    \"description\": \"CLI tool for Minty application\",\n    \"main\": \"src/index.js\",\n    \"type\": \"module\",\n    \"bin\": {\n        \"minty\": \"./bin/minty.js\"\n    },\n    \"scripts\": {\n        \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n    },\n    \"keywords\": [\n        \"minty\",\n        \"cli\",\n        \"agent\"\n    ],\n    \"author\": \"Minty Authors\",\n    \"license\": \"ISC\",\n    \"dependencies\": {\n        \"commander\": \"^12.0.0\",\n        \"chalk\": \"^5.3.0\",\n        \"fast-glob\": \"^3.3.2\"\n    }\n}"
    },
    {
      "path": "bin/minty.js",
      "size": 48,
      "tokens": 12,
      "lastModified": "2026-01-09T14:07:07.373Z",
      "content": "#!/usr/bin/env node\n\nimport('../src/index.js');\n"
    },
    {
      "path": "src/index.js",
      "size": 5582,
      "tokens": 1396,
      "lastModified": "2026-01-09T14:13:37.044Z",
      "content": "import {Command} from 'commander';\nimport chalk from 'chalk';\nimport fs from 'node:fs/promises';\nimport path from 'node:path';\nimport crypto from 'node:crypto';\nimport glob from 'fast-glob';\n\nconst program = new Command();\n\nprogram\n    .name('minty')\n    .description('Minty CLI tool for codebase indexing')\n    .version('0.1.0');\n\n// Simple heuristic to check if file is binary\nasync function isBinaryFile(filepath) {\n    try {\n        const handle = await fs.open(filepath, 'r');\n        const buffer = Buffer.alloc(4096);\n        const {bytesRead} = await handle.read(buffer, 0, 4096, 0);\n        await handle.close();\n\n        // Check for null bytes\n        for (let i = 0; i < bytesRead; i++) {\n            if (buffer[i] === 0) {\n                return true;\n            }\n        }\n        return false;\n    } catch (error) {\n        return false; // dynamic files or access errors\n    }\n}\n\nprogram\n    .command('index')\n    .description('Index the current directory')\n    .argument('[directory]', 'Directory to index', '.')\n    .option('--full', 'Include full file content in .minty file', true) // Default true for agents\n    .action(async (directory, options) => {\n        try {\n            const targetDir = path.resolve(process.cwd(), directory);\n            console.log(chalk.blue(`Indexing directory: ${targetDir}`));\n\n            try {\n                const stats = await fs.stat(targetDir);\n                if (!stats.isDirectory()) {\n                    console.error(chalk.red('Error: Target path is not a directory'));\n                    process.exit(1);\n                }\n            } catch (err) {\n                console.error(chalk.red(`Error: Directory not found: ${targetDir}`));\n                process.exit(1);\n            }\n\n            const mintyFilePath = path.join(targetDir, '.minty');\n            const markdownFilePath = path.join(targetDir, 'codebase.md');\n\n            let projectId = crypto.randomUUID();\n            try {\n                const existingContent = await fs.readFile(mintyFilePath, 'utf-8');\n                const existingConfig = JSON.parse(existingContent);\n                if (existingConfig.projectId) {\n                    projectId = existingConfig.projectId;\n                }\n            } catch (e) {\n                // Ignore\n            }\n\n            console.log(chalk.gray('Scanning files...'));\n            // Using fast-glob which respects .gitignore if we configure it, or we manually check\n            // fast-glob doesn't automatically read .gitignore, we'd need another lib or manual config.\n            // For now, let's use standard exclude patterns.\n            const filePaths = await glob('**/*', {\n                cwd: targetDir,\n                ignore: ['**/node_modules/**', '**/dist/**', '**/.git/**', '**/.minty', '**/codebase.md', '**/package-lock.json', '**/yarn.lock'],\n                dot: true,\n                onlyFiles: true\n            });\n\n            console.log(chalk.green(`Found ${filePaths.length} files. Processing content...`));\n\n            const processedFiles = [];\n            let totalTokens = 0;\n            let codebaseMarkdown = `# Codebase Dump\\n\\n`;\n\n            for (const filePath of filePaths) {\n                const fullPath = path.join(targetDir, filePath);\n                const stats = await fs.stat(fullPath);\n\n                // Skip large files (> 1MB)\n                if (stats.size > 1024 * 1024) {\n                    console.log(chalk.yellow(`Skipping large file: ${filePath}`));\n                    continue;\n                }\n\n                if (await isBinaryFile(fullPath)) {\n                    console.log(chalk.yellow(`Skipping binary file: ${filePath}`));\n                    continue;\n                }\n\n                try {\n                    const content = await fs.readFile(fullPath, 'utf-8');\n                    const tokens = Math.ceil(content.length / 4); // Rough estimation\n                    totalTokens += tokens;\n\n                    processedFiles.push({\n                        path: filePath,\n                        size: stats.size,\n                        tokens: tokens,\n                        lastModified: stats.mtime.toISOString(),\n                        content: content\n                    });\n\n                    // Append to markdown\n                    codebaseMarkdown += `## File: ${filePath}\\n\\`\\`\\`\\n${content}\\n\\`\\`\\`\\n\\n`;\n\n                } catch (readErr) {\n                    console.error(chalk.red(`Failed to read ${filePath}: ${readErr.message}`));\n                }\n            }\n\n            const config = {\n                version: '1.1.0',\n                lastScanned: new Date().toISOString(),\n                projectId: projectId,\n                totalFiles: processedFiles.length,\n                totalTokens: totalTokens,\n                files: processedFiles\n            };\n\n            // Write .minty (JSON)\n            await fs.writeFile(mintyFilePath, JSON.stringify(config, null, 2));\n\n            // Write codebase.md (Markdown for LLM)\n            await fs.writeFile(markdownFilePath, codebaseMarkdown);\n\n            console.log(chalk.green('Indexing complete!'));\n            console.log(chalk.white(`- .minty (JSON Data): ${mintyFilePath}`));\n            console.log(chalk.white(`- codebase.md (LLM Context): ${markdownFilePath}`));\n            console.log(chalk.cyan(`Total Tokens (Est): ${totalTokens}`));\n\n        } catch (error) {\n            console.error(chalk.red('Error indexing directory:'), error.message);\n            process.exit(1);\n        }\n    });\n\nprogram.parse();\n"
    }
  ]
}